<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>IoT Patient Monitoring</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="\styles\styles.css">
  <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"> -->
  <!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"> -->
  <!-- CSS only -->
  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

</head>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script> -->

<body>

  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <a class="navbar-brand">Dashboard</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav">
        <li class="nav-item active">
          <a class="nav-link" href="http://localhost/html/index.html">Home <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="http://localhost/html/index.html">Reload site</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="http://localhost/html/logs.html">Logs</a>
        </li>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            More
          </a>
          <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
            <a class="dropdown-item" href="#">Action</a>
            <a class="dropdown-item" href="#">Another action</a>
            <a class="dropdown-item" href="#">Something else here</a>
          </div>
        </li>
      </ul>
    </div>
  </nav>

  <!-- <div id="updates"></div>
      <div id="updates2"></div> -->
      <h2 align="center">Patient Monitoring Website</h2>
      <div class="real-time-data">

        <!-- <h2>Patient Monitoring Website</h2> -->
        <h3>Patient 1</h3>
        <h1> Pulse = <span class="u1 " id="updates"></span> Bpm </h1>
        <h1> SpO2 = <span class="u2" id="updates2"></span> % </h1>
        <h1> Temperature = <span class="u3" id="updates3"></span> °C </h1>
        <h2> Patient condition : <span class="u4" id="updates4">normal</span></h2>

      </div>

      <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
        More+
    </button>
  <div class="collapse" id="collapseExample">
  <div class="card card-body">
  <div class="div1" >

  <!-- <div id="chartContainer" style="height: 370px; width: 100%;"></div>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script> -->

  <!-- <div class="spreadsheet"> -->
  <!-- <iframe width="100%" height="100%" scrolling="yes" src="https://1drv.ms/x/s!Ah-oPmW7xXqx8HQK47i3I34xBFRS?e=g0WJnt"></iframe> -->
  <!-- width="402" height="346" frameborder="0" scrolling="no" -->
  <!-- </div> -->

  <!-- <div id="myExcelDiv" style="width: 402px; height: 346px"></div> -->
  <!-- * This code uses the Microsoft Office Excel Javascript object model to programmatically insert the
	 * Excel Web App into a div with id=myExcelDiv. The full API is documented at
	 * https://msdn.microsoft.com/en-US/library/hh315812.aspx. There you can find out how to programmatically get
	 * values from your Excel file and how to use the rest of the object model. -->
  <!-- <script type="text/javascript" src="https://1drv.ms/x/s!Ah-oPmW7xXqx8HQK47i3I34xBFRS?e=b8cqzE"></script> -->

  <div class="graph1">
    <iframe width="450" height="250" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/1943514/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=column"></iframe>
    <!-- https://thingspeak.com/channels/1780944/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15 -->
  </div>

  <div class="graph2">
    <iframe width="450" height="250" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/1943514/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=column"></iframe>
    <!-- https://thingspeak.com/channels/1780944/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15 -->
  </div>
  <div class="graph3">
    <iframe width="450" height="250" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/1943514/charts/3?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=column"></iframe>
    <!-- https://thingspeak.com/channels/1780944/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15 -->
  </div>

</div>
</div>

</div>
        <hr>
<!-- <div class="div2"> -->
  <div class="real-time-data2">

    <!-- <h2>Patient Monitoring Website</h2> -->
    <h3>Patient 2</h3>
    <h1> Pulse = <span class="u1 " id="updates5"></span> Bpm </h1>
    <h1> SpO2 = <span class="u2 " id="updates6"></span> % </h1>
    <h1> Temperature = <span class="u3" id="updates7"></span> °C </h1>
    <h2> Patient condition : <span class="u4" id="updates8">normal</span></h2>

  </div>
  <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample2" aria-expanded="false" aria-controls="collapseExample">
    More+
</button>
<div class="collapse" id="collapseExample2">
<div class="card card-body">
<div class="div2">

  <div class="graph1">
<iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/1943517/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=column"></iframe>    <!-- https://thingspeak.com/channels/1780944/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15 -->
  </div>

  <div class="graph2">
    <iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/1943517/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=column"></iframe>
    <!-- https://thingspeak.com/channels/1780944/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15 -->
  </div>
  <div class="graph3">
    <iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/1943517/charts/3?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=column"></iframe>
    <!-- https://thingspeak.com/channels/1780944/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15 -->
  </div>
</div>

</div>
</div>
  <hr>
<!-- <div class="div3"> -->
  <div class="real-time-data3">

    <!-- <h2>Patient Monitoring Website</h2> -->
    <h3>Patient 3</h3>
    <h1> Pulse = <span class="u1 " id="updates9"></span> Bpm </h1>
    <h1> SpO2 = <span class="u2" id="updates10"></span> % </h1>
    <h1> Temperature = <span class="u3" id="updates11"></span> °C </h1>
    <h2> Patient condition : <span class="u4" id="updates12">normal</span></h2>

  </div>
  <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample3" aria-expanded="false" aria-controls="collapseExample">
    More+
</button>
<div class="collapse" id="collapseExample3">
<div class="card card-body">
<div class="div3">
  <div class="graph1">
<iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/1943526/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=column"></iframe>    <!-- https://thingspeak.com/channels/1780944/charts/1?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15 -->
  </div>

  <div class="graph2">
    <iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/1943526/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=column"></iframe>
    <!-- https://thingspeak.com/channels/1780944/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15 -->
  </div>
  <div class="graph3">
    <iframe width="450" height="260" style="border: 1px solid #cccccc;" src="https://thingspeak.com/channels/1943526/charts/3?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=column"></iframe>
    <!-- https://thingspeak.com/channels/1780944/charts/2?bgcolor=%23ffffff&color=%23d62020&dynamic=true&results=60&type=line&update=15 -->
  </div>
</div>
</div>
</div>
    <hr>
    <div class="submit-form">
      <form action="http://localhost" method="post">
        <label for="dateInput1">Date from: </label>
        <input id="dateInput1" type="date" name="from">
        <label for="dateInput2">Date to: </label>
        <input id="dateInput2" type="date" name="to">
        <button type="submit">Submit</button>
      </form>

    </div>
  <div class="tbl">

    <input type="file" id="csvFileInput" style="padding-bottom: 15px">
        <table id="csvRoot"></table>

      <script src="https://cdn.jsdelivr.net/npm/papaparse@5.2.0/papaparse.min.js"></script>

  </div>

  <div class="footer">
    <footer class="bg-light text-center text-lg-start">
      <!-- Copyright -->
      <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
        © 2022 Copyright:
      </div>
      <!-- Copyright -->
    </footer>
  </div>

</body>
<script type="text/javascript">
  var source = new EventSource('/new-project')

  source.addEventListener('message', function(e) {

    // const { ticker } = JSON.parse(e.data);
    // document.getElementById('updates').innerText = {ticker};
    // var value = e.data;
    var value2 = e.data.split('\n')
    var my_first_val = value2[0];
    var my_second_val = value2[1];
    var my_third_val = Math.round(value2[2]);
    var my_fourth_val = value2[3];
    var my_fifth_val = value2[4];
    var my_sixth_val = Math.round(value2[5]);
    var my_seventh_val = value2[6];
    var my_eighth_val = value2[7];
    var my_nineth_val = Math.round(value2[8]);

    // document.getElementById('updates').innerText = value;
    // console.log(value2);
    // console.log(my_first);
    document.getElementById('updates').innerText = my_first_val;
    document.getElementById('updates2').innerText = my_second_val;
    document.getElementById('updates3').innerText = my_third_val;
    document.getElementById('updates5').innerText = my_fourth_val;
    document.getElementById('updates6').innerText = my_fifth_val;
    document.getElementById('updates7').innerText = my_sixth_val;
    document.getElementById('updates9').innerText = my_seventh_val;
    document.getElementById('updates10').innerText = my_eighth_val;
    document.getElementById('updates11').innerText = my_nineth_val;
    if(my_second_val < 85){
      // document.getElementById('updates2').style.color = "red";
      document.getElementById('updates4').innerText = "Abnormal";
    }
    else if (my_second_val > 85) {
      document.getElementById('updates4').innerText = "Normal";
    }
    else if(my_first_val < 65 || my_first_val > 120){
      // document.getElementById('updates1').style.color = "red";
      document.getElementById('updates4').innerText = "Abnormal";
    }
    else if (my_first_val > 65 || my_first_val < 120) {
      document.getElementById('updates4').innerText = "Normal";
    }
    else if(my_third_val == -127){
      // document.getElementById('updates3').style.color = "red";
      document.getElementById('updates3').innerText = "Temperature error";
    }
    else if(my_third_val < 30 || my_third_val > 38 ){
      // document.getElementById('updates3').style.color = "red";
      document.getElementById('updates4').innerText = "Abnormal";
    }
    else if (my_third_val > 30 || my_third_val < 38 ) {
      document.getElementById('updates4').innerText = "Normal";
    }
    //patient 2
     if(my_fifth_val < 85){
      // document.getElementById('updates2').style.color = "red";
      document.getElementById('updates8').innerText = "Abnormal";
    }
    else if (my_fifth_val > 85) {
      document.getElementById('updates8').innerText = "Normal";
    }
    else if(my_fourth_val < 65 || my_fourth_val > 120){
      // document.getElementById('updates1').style.color = "red";
      document.getElementById('updates8').innerText = "Abnormal";
    }
    else if (my_fourth_val > 65 || my_fourth_val < 120) {
      document.getElementById('updates8').innerText = "Normal";
    }
    else if(my_sixth_val == -127){
      // document.getElementById('updates3').style.color = "red";
      document.getElementById('updates7').innerText = "Temperature error";
    }
    else if(my_sixth_val < 30 || my_sixth_val > 38 ){
      // document.getElementById('updates3').style.color = "red";
      document.getElementById('updates8').innerText = "Abnormal";
    }
    else if (my_sixth_val > 30 || my_sixth_val < 38 ) {
      document.getElementById('updates8').innerText = "Normal";
    }
    //patient 3
    if(my_eighth_val < 85){
      // document.getElementById('updates2').style.color = "red";
      document.getElementById('updates12').innerText = "Abnormal";
    }
    else if (my_eighth_val > 85) {
      document.getElementById('updates12').innerText = "Normal";
    }
    else if(my_seventh_val < 65 || my_seventh_val > 120){
      // document.getElementById('updates1').style.color = "red";
      document.getElementById('updates12').innerText = "Abnormal";
    }
    else if (my_seventh_val > 65 || my_seventh_val < 120) {
      document.getElementById('updates12').innerText = "Normal";
    }
    else if(my_nineth_val == -127){
      // document.getElementById('updates3').style.color = "red";
      document.getElementById('updates11').innerText = "Temperature error";
    }
    else if(my_nineth_val < 30 || my_nineth_val > 38 ){
      // document.getElementById('updates3').style.color = "red";
      document.getElementById('updates12').innerText = "Abnormal";
    }
    else if (my_nineth_val > 30 || my_nineth_val < 38 ) {
      document.getElementById('updates12').innerText = "Normal";
    }

  }, false)


  // table element program
  class TableCsv {
    /**
     * @param {HTMLTableElement} root The table element which will display the CSV data.
     */
    constructor(root) {
      this.root = root;
    }

    /**
     * Clears existing data in the table and replaces it with new data.
     *
     * @param {string[][]} data A 2D array of data to be used as the table body
     * @param {string[]} headerColumns List of headings to be used
     */
     //["time", "id", "pulse", "spo2", "temperature"]
    update(data, headerColumns = []) {
      this.clear();
      // this.setHeader(headerColumns);
      this.setHeader(["Time", "entry_id", "Pulse", "SpO2", "Temperature"]);
      this.setBody(data);
    }

    /**
     * Clears all contents of the table (incl. the header).
     */
    clear() {
      this.root.innerHTML = "";
    }

    /**
     * Sets the table header.
     *
     * @param {string[]} headerColumns List of headings to be used
     */
    setHeader(headerColumns) {
      this.root.insertAdjacentHTML(
        "afterbegin",
        `
              <thead>
                  <tr>
                      ${headerColumns.map((text) => `<th>${text}</th>`).join("")}
                  </tr>
              </thead>
          `
      );
    }

    /**
     * Sets the table body.
     *
     * @param {string[][]} data A 2D array of data to be used as the table body
     */
    setBody(data) {
      const rowsHtml = data.map((row) => {
        return `
                  <tr>
                      ${row.map((text) => `<td>${text}</td>`).join("")}
                  </tr>
              `;
      });

      this.root.insertAdjacentHTML(
        "beforeend",
        `
              <tbody>
                  ${rowsHtml.join("")}
              </tbody>
          `
      );
    }
  }

  const tableRoot = document.querySelector("#csvRoot");
  const csvFileInput = document.querySelector("#csvFileInput");
  const tableCsv = new TableCsv(tableRoot);

  csvFileInput.addEventListener("change", (e) => {
    Papa.parse(csvFileInput.files[0], {
      delimiter: ",",
      skipEmptyLines: true,
      complete: (results) => {
        tableCsv.update(results.data.slice(1), results.data[0]);
      }
    });
  });
// table element program end

</script>

</html>

<!-- //http://localhost/html/index.html -->
<!-- https://onedrive.live.com/view.aspx?resid=B17AC5BB653EA81F!14452&ithint=file%2cxlsx&authkey=!AArjuLcjfjEEVFI -->
<!-- https://1drv.ms/x/s!Ah-oPmW7xXqx8HQK47i3I34xBFRS?e=g0WJnt -->
